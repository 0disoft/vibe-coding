/* ═══════════════════════════════════════════════════════════════════════════
   Design Tokens
   CSS 변수: 색상, 폰트, 사이즈 스케일
   ═══════════════════════════════════════════════════════════════════════════ */

/* ───────────────────────────────────────────────────────────
   Font Imports (로컬 호스팅)
   ─────────────────────────────────────────────────────────── */
/* 한국어 */
@import "pretendard/dist/web/variable/pretendardvariable.css";
/* 일본어 */
@import "@fontsource-variable/noto-sans-jp";
/* 중국어 (간체) */
@import "@fontsource-variable/noto-sans-sc";
/* 아랍어 */
@import "@fontsource-variable/noto-sans-arabic";
/* 태국어 */
@import "@fontsource-variable/noto-sans-thai";
/* 힌디어 (데바나가리) */
@import "@fontsource-variable/noto-sans-devanagari";
/* 영어/라틴 문자 */
@import "@fontsource-variable/inter";
/* Maple Mono */
@import "@fontsource/maple-mono";

/* Manrope (Variable) */
@import "@fontsource-variable/manrope";

:root {
	color-scheme: light dark;

	/* UnoCSS text-xs 오버라이드 (기본 0.75rem → 0.65rem) */
	--text-xs-fontSize: 0.65rem;

	/* 메뉴 폰트 크기 (3단계) */
	--fs-menu-lg: 0.95rem;
	--fs-menu: 0.85rem;
	--fs-menu-sm: 0.75rem;

	/* Font stacks */
	/* 기본(라틴 문자 기반) - 현재 테스트: Manrope */
	--font-sans:
		"Manrope Variable", "Manrope", "Inter Variable", Inter, -apple-system, BlinkMacSystemFont,
		system-ui, "Segoe UI", Roboto, "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji",
		"Noto Color Emoji", sans-serif;
	--font-mono:
		"Maple Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
		"Courier New", monospace;

	/* Inter 폰트 최적화: cv05(l 구분), calt(문맥 대체) */
	font-feature-settings: "cv05", "calt", "kern", "liga";

	/* Font scale (1~9). 0.05 간격: 1=1.05 … 5=1.25(기본) … 9=1.45 */
	--fs-scale: 1;

	/* 뷰포트 높이 기반 동적 스케일링 (1080px 기준 정규화) */
	/* sqrt() 함수로 극단값 완화, clamp()로 0.55~1.9 범위 제한 */
	--vh-factor: clamp(0.55, sqrt(100dvh / 1080px), 1.9);

	font-size: calc(21px * var(--fs-scale) * var(--vh-factor));

	/* Base font sizes */
	--fs-body-base: 1.35rem;
	--fs-body-secondary-base: 1.2rem;
	--fs-comment-base: 1.25rem;
	--fs-code-base: 0.75rem;
	--fs-xs-base: 0.65rem;
	--fs-h1-base: 2.2rem;
	--fs-h2-base: 1.8rem;
	--fs-h3-base: 1.5rem;
	--fs-caption-base: 1rem;

	/* Computed font tokens */
	--fs-body: var(--fs-body-base);
	--fs-body-secondary: var(--fs-body-secondary-base);
	--fs-comment: var(--fs-comment-base);
	--fs-code: var(--fs-code-base);
	--fs-xs: var(--fs-xs-base);
	--fs-h1: var(--fs-h1-base);
	--fs-h2: var(--fs-h2-base);
	--fs-h3: var(--fs-h3-base);
	--fs-caption: var(--fs-caption-base);

	/* Line heights */
	--lh-body: 1.6;
	--lh-heading: 1.3;

	/* gleam.run inspired light palette */
	--background: 98.2% 0.008 102;
	--foreground: 35% 0.04 331;

	/* 카드, 팝오버, 포커스 영역 등 */
	--card: 96% 0.02 102;
	--code-card: 95% 0.02 102;
	--code-card-foreground: 35% 0.04 331;
	--card-foreground: 35% 0.04 331;

	--popover: 97.4% 0.02 102;
	--popover-foreground: 35% 0.04 331;

	/* 주요 액션 */
	--primary: 88% 0.1265 332;
	--primary-foreground: 19% 0.015 332;

	/* 보조 액션 / 서브 버튼 */
	--secondary: 92% 0.0746 209;
	--secondary-foreground: 20% 0.02 209;

	/* 강조 요소 (배지, 토글 등) */
	--accent: 94% 0.03 97;
	--accent-foreground: 24% 0.02 97;

	/* 링크 */
	--link: 62% 0.12 209;
	--link-foreground: 20% 0.02 209;

	/* 약한 텍스트, 서브 카드 배경 등 */
	--muted: 93% 0.01 106;
	--muted-foreground: 45% 0.02 106;

	/* 파괴적 액션 (삭제, 로그아웃 등) */
	--destructive: 60% 0.15 25;
	--destructive-foreground: 98% 0.01 25;

	/* 성공 상태 (연두색) */
	--success: 65% 0.15 150;
	--success-foreground: 98% 0.01 150;

	/* 경고 상태 (노란색) */
	--warning: 70% 0.15 75;
	--warning-foreground: 98% 0.01 90;

	/* 경계 / 입력 / 포커스 링 */
	--border: 92% 0.008 106;
	--input: 93% 0.008 106;
	--ring: 85.14% 0.1265 332;

	/* 네비게이션/오버레이 */
	--sidebar: 97% 0.012 106;
	--sidebar-foreground: 32% 0.025 331;
	--overlay: 24% 0.015 274;
}

/* ───────────────────────────────────────────────────────────
   CJK Common Settings (Experimental)
   한중일 문자 간격 자동 정리
   ─────────────────────────────────────────────────────────── */
:lang(zh),
:lang(zh-CN),
:lang(zh-TW),
:lang(zh-Hans),
:lang(zh-Hant) {
	/* CJK + 영문/숫자 사이 공백 자동 조정 (적극적 모드) */
	text-spacing-trim: trim-start;
}

/* ───────────────────────────────────────────────────────────
   Latin / Western Typography
   ─────────────────────────────────────────────────────────── */
:lang(en),
:lang(fr),
:lang(de),
:lang(es),
:lang(it),
:lang(pt),
:lang(nl),
:lang(sv) {
	hyphens: auto;
	overflow-wrap: anywhere;
	font-variant-numeric: tabular-nums;
	/* Manrope 무게감 조정 (Pretendard 450과 균형 맞춤) */
	font-weight: 450;
}

/* ───────────────────────────────────────────────────────────
   Language-Specific Font Stacks (하이브리드 전략)
   ─────────────────────────────────────────────────────────── */

/* 한국어 - Pretendard */
:lang(ko),
html:lang(ko),
html:lang(ko-KR),
body:lang(ko),
body:lang(ko-KR) {
	--font-sans:
		"Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, "Segoe UI",
		Roboto, "Helvetica Neue", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic",
		"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
	/* 한글 자간 미세 조정 (-0.02em: Pretendard 권장 범위) */
	letter-spacing: -0.02em;
	/* 단어 단위 줄바꿈 + 긴 URL 깨짐 방지 안전장치 */
	word-break: keep-all;
	overflow-wrap: anywhere;
	font-weight: 450;
	/* ss05: 원화 기호 등 스타일, cv11: 6/9 판독성 강화 */
	font-feature-settings: "kern", "liga", "locl", "calt", "ss05", "cv11";
	/* 본문 숫자는 가변폭(proportional)이 자연스러움 */
	font-variant-numeric: proportional-nums;
}

/* 한국어 UI 텍스트 미세 조정 (본문보다 살짝 덜 조임) */
:lang(ko) small,
:lang(ko) button,
:lang(ko) input,
:lang(ko) label {
	letter-spacing: -0.01em;
}

/* 일본어 - Noto Sans JP */
:lang(ja),
html:lang(ja),
body:lang(ja) {
	--font-sans:
		"Noto Sans JP Variable", "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo,
		system-ui, sans-serif;
	/* Variable Font 무게 일관성을 위해 명시적 지정 */
	font-weight: 400;
	/* chws: 문장부호 간격 / case: 기호 정렬 / pkna: 가나 폭 최적화 */
	font-feature-settings: "palt", "pkna", "kern", "liga", "chws", "case";
	/* 일본어 줄바꿈 규칙 강화 (금칙 처리) */
	line-break: strict;
	word-break: normal;
	/* 일본어 자간 최적화 (너무 좁히지 않고 살짝 여유) */
	letter-spacing: 0.02em;
	/* 고정폭 숫자 */
	font-variant-numeric: tabular-nums;
	/* CJK 비례폭 사용 (웹 UI에 유리) */
	font-variant-east-asian: proportional-width;
}

/* 일본어 본문/UI 자간 분리 및 헤딩 밸런스 */
:lang(ja) p {
	letter-spacing: -0.01em;
}

:lang(ja) small,
:lang(ja) button {
	letter-spacing: 0;
}

:lang(ja) h1,
:lang(ja) h2,
:lang(ja) h3 {
	text-wrap: balance;
}

/* 중국어 간체 - Noto Sans SC */
:lang(zh),
:lang(zh-CN),
:lang(zh-Hans),
html:lang(zh),
body:lang(zh) {
	--font-sans:
		"Noto Sans SC Variable", "Noto Sans SC", "PingFang SC", "Microsoft YaHei", system-ui, sans-serif;
	/* 중국어 자간 및 줄바꿈 최적화 + 지역형/커닝/문맥반각 */
	letter-spacing: 0.02em;
	/* anywhere는 단어 중간 끊김 위험 -> strict 권장 */
	line-break: strict;
	font-feature-settings: "palt", "locl", "kern", "liga", "chws";
	font-variant-numeric: lining-nums proportional-nums;
	font-variant-east-asian: proportional-width;
	word-break: normal;
}

/* 중국어 본문 양쪽 정렬 최적화 */
:lang(zh) p {
	text-align: justify;
	text-justify: inter-ideograph;
}

/* 중국어 번체 - Noto Sans SC (fallback) */
:lang(zh-TW),
:lang(zh-Hant) {
	--font-sans:
		"Noto Sans SC Variable", "Noto Sans SC", "PingFang TC", "Microsoft JhengHei", system-ui,
		sans-serif;
	/* 중국어 자간 및 줄바꿈 최적화 + 지역형/커닝/문맥반각 */
	letter-spacing: 0.02em;
	line-break: strict;
	font-feature-settings: "palt", "locl", "kern", "liga", "chws";
	font-variant-numeric: lining-nums proportional-nums;
	font-variant-east-asian: proportional-width;
	word-break: normal;
}

/* 아랍어 - Noto Sans Arabic (RTL) */
:lang(ar),
html:lang(ar),
body:lang(ar) {
	direction: rtl;
	text-align: start;
	/* 혼합 텍스트에서 방향성 격리 (isolate-override는 너무 강력함) */
	unicode-bidi: isolate;
	--font-sans:
		"Noto Sans Arabic Variable", "Noto Sans Arabic", "Geeza Pro", "Segoe UI", Tahoma, system-ui,
		sans-serif;
	/* 단순화: 엔진이 필수 처리하는 기능 제외 (calt, liga, rlig 유지) */
	font-feature-settings: "calt", "liga", "rlig";
	/* 자간 조정 금지 (연결 끊김 방지) */
	letter-spacing: 0;
	/* 아랍어는 장식(Diacritics) 때문에 높은 행간 필요 */
	line-height: 1.8;
	font-variant-numeric: tabular-nums;
}

/* RTL 언어에서도 코드 블록은 항상 LTR */
html:lang(ar) pre:where(pre) span,
html:lang(ar) code:where(code) span {
	direction: ltr;
	text-align: left;
	unicode-bidi: embed;
}

html:lang(ar) pre:where(pre),
html:lang(ar) code:where(code),
html:lang(ar) kbd:where(kbd),
html:lang(ar) samp:where(samp) {
	direction: ltr;
	text-align: left;
	unicode-bidi: embed;
}

/* 힌디어 - Noto Sans Devanagari */
:lang(hi),
html:lang(hi),
body:lang(hi) {
	--font-sans:
		"Noto Sans Devanagari Variable", "Noto Sans Devanagari", "Kohinoor Devanagari", "Mangal",
		system-ui, sans-serif;
	/* 단순화: 복잡한 처리는 셰이퍼에게 위임 (liga, calt 유지) */
	font-feature-settings: "liga", "calt";
	letter-spacing: 0;
	line-height: 1.7;
	/* 합자 처리를 위한 표준 속성 */
	font-variant-ligatures: common-ligatures contextual;
	font-variant-numeric: tabular-nums;
}

/* 태국어 - Noto Sans Thai */
:lang(th),
html:lang(th),
body:lang(th) {
	--font-sans:
		"Noto Sans Thai Variable", "Noto Sans Thai", "Leelawadee UI", "Tahoma", system-ui, sans-serif;
	/* 성조/모음 마크 위치 최적화 (단순화: liga, calt 유지) */
	font-feature-settings: "liga", "calt";
	letter-spacing: 0;
	line-height: 1.8;
}

/* 힌디어/태국어 공통: 밑줄이 모음/성조 가리지 않게 */
:lang(hi),
:lang(th) {
	text-decoration-skip-ink: auto;
	text-underline-position: under;
}

/* 러시아어 - 시스템 폰트 (키릴 문자 지원) */
:lang(ru),
html:lang(ru),
body:lang(ru) {
	--font-sans:
		-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, system-ui,
		sans-serif;
	/* 대문자/숫자용 기호 위치 보정 (case) */
	font-feature-settings: "kern", "liga", "calt", "case";
	hyphens: auto;
	font-variant-numeric: tabular-nums;
}

/* ───────────────────────────────────────────────────────────
   Font Size Scale Variants
   ─────────────────────────────────────────────────────────── */
:root[data-font-size="1"] {
	--fs-scale: 1.05;
}

:root[data-font-size="2"] {
	--fs-scale: 1.1;
}

:root[data-font-size="3"] {
	--fs-scale: 1.15;
}

:root[data-font-size="4"] {
	--fs-scale: 1.2;
}

:root[data-font-size="5"] {
	--fs-scale: 1.25;
}

:root[data-font-size="6"] {
	--fs-scale: 1.3;
}

:root[data-font-size="7"] {
	--fs-scale: 1.35;
}

:root[data-font-size="8"] {
	--fs-scale: 1.4;
}

:root[data-font-size="9"] {
	--fs-scale: 1.45;
}

/* ───────────────────────────────────────────────────────────
   Dark Theme
   ─────────────────────────────────────────────────────────── */
:root[data-theme="dark"] {
	color-scheme: dark;

	/* gleam.run inspired dark palette */
	--background: 30.09% 0.0314 274;
	--foreground: 96% 0.01 106;

	--card: 33% 0.0314 274;
	--code-card: 27% 0.0314 274;
	--code-card-foreground: 96% 0.01 106;
	--card-foreground: 96% 0.01 106;

	--popover: 35% 0.0314 274;
	--popover-foreground: 96% 0.01 106;

	/* 주요 액션 */
	--primary: 86% 0.1265 332;
	--primary-foreground: 14% 0.02 332;

	/* 보조 액션 / 서브 버튼 */
	--secondary: 88% 0.0746 209;
	--secondary-foreground: 14% 0.02 209;

	/* 강조 요소 (배지, 토글, hover 등) */
	--accent: 45% 0.04 274;
	--accent-foreground: 94% 0.01 97;

	/* 링크 */
	--link: 86% 0.12 209;
	--link-foreground: 94% 0.01 209;

	/* 약한 텍스트, 서브 카드 배경, hover 등 */
	--muted: 42% 0.02 274;
	--muted-foreground: 88% 0.015 106;

	/* 파괴적 액션 (삭제 등) */
	--destructive: 88% 0.1 25;
	--destructive-foreground: 14% 0.02 25;

	/* 성공 / 경고 상태 */
	--success: 82% 0.09 150;
	--success-foreground: 14% 0.02 150;

	--warning: 86% 0.1 45;
	--warning-foreground: 14% 0.02 95;

	/* 경계 / 입력 / 포커스 링 */
	--border: 36% 0.012 274;
	--input: 38% 0.012 274;
	--ring: 82% 0.1265 332;

	/* 네비게이션/오버레이 */
	--sidebar: 26% 0.015 274;
	--sidebar-foreground: 90% 0.01 106;
	--overlay: 10% 0.01 274;
}

/* ───────────────────────────────────────────────────────────
   Mobile Optimization
   ─────────────────────────────────────────────────────────── */
@media (max-width: 768px) {

	:lang(ko),
	:lang(ja),
	:lang(zh),
	:lang(zh-CN),
	:lang(zh-Hans),
	:lang(zh-TW),
	:lang(zh-Hant) {
		/* CJK 언어 줄간격 최적화 */
		line-height: 1.7;
	}

	:lang(ar),
	:lang(hi),
	:lang(th) {
		/* 복잡한 스크립트는 줄간격 여유 */
		line-height: 1.8;
	}
}
