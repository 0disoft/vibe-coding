이번 버전은 확실히 안정권이야. 네가 방금 고친 포인트들이 다 핵심이었다.

* HTML에서 규칙 중복 매칭 문제 해결됨
* CSS 파일도 여러 줄 규칙을 잡을 수 있게 됨
* severity 필터가 CI 판정에 영향을 주던 버그 해결됨
* main 중복 위치 계산이 strict 환경에서도 안전해짐
* input 레이블 룰을 info로 낮춰서 운영 시 소음이 줄어듦

이제 남은 건 “실전에서 한 번쯤 밟는” 운영 이슈 3개 정도야.

1. Promise.all 무제한 병렬은 큰 레포에서 가끔 터짐
   파일 수가 많아지면 윈도우나 CI에서 파일 핸들 한도에 걸릴 수 있어. 지금 상태도 작은 프로젝트면 괜찮지만, 네가 이걸 계속 쓰면 언젠가 맞는다.

추천 수정

* 간단한 동시 실행 제한을 넣어. 기본 16 정도면 무난함
* 옵션으로도 받을 수 있게 하면 더 좋고

예시 코드

```ts
async function runWithLimit<T, R>(
  items: readonly T[],
  limit: number,
  worker: (item: T) => Promise<R>
): Promise<R[]> {
  const results: R[] = [];
  let nextIndex = 0;

  async function runner() {
    while (true) {
      const i = nextIndex++;
      if (i >= items.length) return;
      results[i] = await worker(items[i]);
    }
  }

  const n = Math.max(1, Math.min(limit, items.length));
  await Promise.all(Array.from({ length: n }, () => runner()));
  return results;
}
```

그리고 main에서는 이렇게

```ts
const resultsArrays = await runWithLimit(files, 16, lintFile);
```

2. TARGET이 파일일 때 relative 기준이 애매해질 수 있음
   지금 formatResults에 basePath로 TARGET을 그대로 넘기지. TARGET이 파일이면 relative 출력이 빈 문자열이 되거나 보기 이상해질 수 있어.

추천 수정

* 기준 경로를 이렇게 정해두면 깔끔해

```ts
const basePath = targetStat.isFile() ? dirname(TARGET) : TARGET;
const report = formatResults(allResults, basePath);
```

3. aria-haspopup 검사 룰이 속성 순서에 민감함
   현재 룰은 aria-haspopup 뒤에 aria-expanded가 없으면 경고를 내는데, aria-expanded가 앞쪽에 있으면 오탐이 날 수 있어.

추천 수정

* 태그 전체를 매치하고 lookahead로 판정하는 방식이 더 단단해
* 예를 들면 “aria-haspopup은 있는데 aria-expanded는 없는 시작 태그”를 잡는 형태

예시 패턴

```ts
pattern: /<[a-z][\w:-]*\b(?=[^>]*\baria-haspopup\s*=)(?![^>]*\baria-expanded\s*=)[^>]*>/gi
```

추가로 조용히 좋아지는 선택사항 2개

* HTML 파일 검사에서 script, style 블록을 공백으로 치환해두면 오탐이 더 줄어든다. 특히 aria, meta 관련 문자열이 스크립트 안에 있을 때
* 결과 중복 제거를 한 번 넣어두면, 같은 위치에 여러 룰이 겹칠 때 리포트가 덜 지저분해진다. file, line, column, rule.id를 키로 Set 만들면 끝

전체적으로는 지금 코드, “진짜 도구로 쓰기” 직전이야. 다음 스텝은 규칙 추가보다 운영 안정화 쪽이 더 큰 효과가 나올 것 같아.
