UnoCSS 컬러 룰: 타입과 작은 유틸

지금 colorRules는 이렇게 되어 있지.

const colorRules: [RegExp, (match: RegExpMatchArray) => Record<string, string>][] = [];


이것도 동작은 하는데, 나중에 룰이 늘어날 걸 생각하면 UnoCSS 쪽 타입을 끌고 오는 편이 유지보수에 좋아.

예를 들어:

import type { Rule } from 'unocss';

const colorRules: Rule<{}>[] = [];

const toAlpha = (opacity?: string) => {
  if (!opacity) return '';
  const n = Number(opacity);
  const clamped = Math.min(100, Math.max(0, n));
  return String(clamped / 100);
};

for (const color of semanticColors) {
  colorRules.push([
    new RegExp(`^bg-${color}(?:\\/(\\d+))?$`),
    ([, opacity]) => {
      const alpha = toAlpha(opacity);
      return {
        'background-color': alpha
          ? `oklch(var(--${color}) / ${alpha})`
          : `oklch(var(--${color}))`
      };
    }
  ]);

  // text, border, ring, outline도 같은 방식
}


장점은:

나중에 UnoCSS 버전이 바뀌어도 타입 추론이 조금 더 잘 붙고

toAlpha 하나만 손보면 모든 유틸이 같이 정리됨

완전 필수는 아닌데 “템플릿에서 복붙을 많이 할 코드”라면 이런 작은 유틸로 중복을 줄여두는 게 좋더라.