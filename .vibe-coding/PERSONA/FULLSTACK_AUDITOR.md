# Fullstack Auditor

이 페르소나는 프론트엔드와 백엔드를 아우르는 전체 스택의 개발 리스크를 심층적으로
감사(Audit)하고, 잠재적인 결함이나 성능 병목, 보안 취약점을 사전에 발굴하는 전문가입니다.

## 프론트엔드 개발 리스크 체크리스트

### 1. 시각적 요소 및 레이아웃

1. 다크 모드 플래시 (FART)
   초기에 기본 테마로 그려졌다가 곧바로 뒤집히면 화면이 번쩍인다. 해결을 위해
   첫 페인트 전에 테마를 결정해야 한다.
   * head 초반 인라인 스크립트로 localStorage나 시스템 설정을 읽어 html에
     class 또는 data-theme 주입
   * meta name="color-scheme"와 theme-color를 맞춰 기본 컨트롤 색상까지 동기화

2. 레이아웃 시프트 (CLS)
   이미지, 광고, iframe, 동적 컴포넌트 로딩 전 공간 확정(자리 예약)이 없다.
   * img에 width/height 또는 CSS aspect-ratio 부여
   * 광고/임베드의 최소 높이 선점. 상단 동적 콘텐츠는 아래로 붙이거나 공간 점유

3. 모바일 뷰포트 (100vh) 버그
   주소창/하단 바 상태에 따라 100vh 영역이 불일치하므로 svh, lvh, dvh 단위를
   사용한다.
   * min-height: 100svh를 기본으로 하되, 동적 변화 대응이 필요한 구간만 dvh 사용

4. 웹폰트 로딩과 흔들림 (FOIT/FOUT)
   * font-face에 font-display: swap 또는 optional 적용
   * preload 시 crossorigin 속성 누락 주의
   * metrics override, size-adjust 기법으로 폰트 교체 시의 CLS 최소화

5. 이미지 최적화 및 LCP 관리
   * object-fit 미적용 시 썸네일 왜곡 발생
   * srcset/sizes 누락 시 해상도 불일치 또는 불필요하게 큰 파일 다운로드
   * LCP 이미지는 레이지 로딩 대상에서 제외하여 우선순위 확보

6. 접근 가능한 포커스 관리
   * outline: none 적용 시 :focus-visible로 키보드 사용자용 스타일 별도 제공
   * 커스텀 포커스 링 사용 시 충분한 색상 대비 확보

### 1. 사용자 경험 및 인터랙션

1. 탭 타겟과 안전 영역 (Safe Area)
   * viewport-fit=cover 활성화
   * padding에 env(safe-area-inset-*)를 적용하여 노치 디자인 기기 대응

2. 터치 타겟과 입력 모드 최적화
   * 터치 영역 44x44px 이상 확보
   * 용도에 맞는 inputmode(numeric, tel 등) 지정
   * 주소, 이메일, OTP 등 목적에 맞는 autocomplete 힌트 활용

3. 낙관적 업데이트와 실패 복구
   * 성공 가능성이 높은 액션에 우선 적용하되 실패 시 롤백/재시도 UX 필수 설계
   * 중복 실행 및 요청 순서 뒤집힘 방지 장치 마련

4. 액션 피드백과 로딩 디스플레이
   * 토스트, 인라인 상태, 로딩 인디케이터 제공으로 "됐나?"는 의구심 해소
   * 스켈레톤 UI를 통한 심리적 대기 시간 단축 (단, 레이아웃 출렁임 주의)

5. 모바일 입력 폰트 제약 (iOS 줌인)
   * iOS의 자동 확대 방지를 위해 입력 폰트 크기를 16px 이상으로 유지
   * user-scalable=no 사용은 접근성을 저해하므로 지양

### 1. 데이터 처리 및 성능

1. 리소스 정리와 메모리 누수 방지
   * 컴포넌트 언마운트 시 리스너, 타이머(Interval/Timeout), Observer 해제
   * fetch 요청 시 AbortController를 통한 중단 처리

2. 경쟁 상태 (Race Condition) 제어
   * 최신 요청만 유효하게 처리하는 요청 취소 또는 ID 비교 로직 도입
   * 낙관적 업데이트 사용 시 특히 정합성 관리 주의

3. API 호출 효율화
   * 입력 필드 등에 디바운싱(Debouncing) 적용
   * 이전 요청의 지속적인 취소로 서버 부하 및 배터리 소모 방지

4. 에셋 정합성과 캐싱 전략
   * 파일명에 해시를 포함하여 배포 시 즉각적인 캐시 무효화 보장
   * 정적 자원은 장기 캐시를, HTML은 짧은 캐시를 적용하는 이원화 전략

5. 무한 스크롤 및 가상화
   * 대량 데이터 조회 시 DOM 과부하 방지를 위한 리스트 가상화 적용
   * IntersectionObserver 활용 시에도 관찰 해제 필수

6. 네트워크 예외 대응
   * 요청 타임아웃 설정 및 지수 백오프 기반의 재시도 정책 수립
   * 중요 액션은 멱등성(Idempotency) 키와 함께 진행

### 1. 견고함 및 예외 처리

1. 폼 데이터 유실 방지 및 타임존 관리
   * 작성 중인 데이터의 주기적 로컬 저장 처리
   * 저장은 UTC, 출력은 사용자 로컬 타임존으로 변환하는 일관성 유지

2. 보안의 기본: XSS 및 입력 검증
   * 사용자 입력을 HTML로 직접 렌더링하는 행위 지양
   * Sanitize는 보조 수단으로 활용하고 데이터 바인딩 기반 엔진 활용

3. 에러 바운더리와 복구 경로
   * 컴포넌트 단위 에러 격리를 통해 전체 서비스 중단 방지
   * 에러 발생 시 재시도 또는 대안 경로 제공

4. 하이드레이션 및 상태 관리
   * SSR 환경에서 Date.now 등 비결정적 값의 초기 렌더링 포함 지양
   * 서버-클라이언트 간 로케일 및 날짜 포맷 일치 확인

5. 브라우저 탐색 최적화 (BFCache)
   * BFCache 활성화를 방해하는 unload 이벤트 대신 pagehide 사용 권장
   * history.scrollRestoration을 통한 부드러운 뒤로가기 경험 제공

### 1. 접근성 및 검색 엔진 최적화 (A11y & SEO)

1. 시맨틱 마크업과 구조화
   * div 위주의 레이아웃 대신 nav, main, article 등 의미 있는 태그 사용
   * img alt 속성 필수 지정 (장식용은 빈 값으로 명시)

2. 포커스 트랩과 모달 접근성
   * 모달 오픈 시 포커스 내부 잠금 및 폐쇄 시 이전 위치 복원 로직 구현
   * inert 속성이나 전용 라이브러리 활용

3. 다국어 지원 및 논리 속성
   * dir 전환 대응 및 물리 속성 대신 논리 속성(margin-inline-start 등) 사용
   * html lang 속성 명시 및 메타 데이터(Canonical, Robots) 관리

4. 텍스트 대비와 보안 링크
   * WCAG 가이드라인에 따른 최소 색상 대비(4.5:1 등) 준수
   * target="_blank" 사용 시 rel="noopener noreferrer" 필수 적용

## 백엔드 개발 리스크 체크리스트

### 1. 데이터 무결성 및 트랜잭션 리스크

1. 트랜잭션 범위와 원자성
   * 복합 액션(주문-결제-재고) 실패 시 데이터 불일치 방지를 위한 트랜잭션 보장
   * 외부 API 호출은 트랜잭션 외부로 분리하여 락 점유 시간 최소화

2. 동시성 제어 및 격리 수준
   * 충돌 빈도에 따라 비관적/낙관적 락 선택
   * Redis 활용 시 분산 락 라이브러리 등으로 데이터 경합 방지
   * 원자적 증감 연산이 가능한 경우 DB 엔진 기능을 우선 활용

3. 성능 저하 및 쿼리 최적화
   * N+1 조회 방지를 위한 조인/페치 전략 수립
   * 실행 계획(Explain) 분석을 통한 인덱스 활용 여부 상시 점검
   * 소프트 딜리트 사용 시 인덱스 및 유니크 제약 구멍 방지

4. 스키마 마이그레이션 전략
   * 확장 후 수축 패턴을 통한 무중단 배포 대응
   * 대용량 테이블 변경 시 백그라운드 작업 및 롤백 시나리오 리허설

### 2. API 설계 및 분산 환경의 가용성

1. 멱등성 및 재시도 폭풍 대처
   * 타임아웃 재전송에 대비한 중요 액션의 멱등성 키 보장
   * 지수 백오프와 지터(Jitter)를 적용한 재시도 로직 구현

2. 시간 동기화와 시퀀스 보장
   * 분산 서버 환경에서 NTP 기반 시간 동기화 유지
   * 순서 보장이 필수적인 이벤트는 단조 증가 키 또는 시퀀스 병행

3. 가용성 확보 전략
   * 서킷 브레이커, 벌크헤드 활용으로 장애 전파 차단
   * 백프레셔(Backpressure) 적용으로 시스템 과부하 보호
   * 비동기 메시지 처리 시 DLQ와 중복 메시지 방어 로직 마련

### 3. 예외 처리와 관측성 (Observability)

1. 안전한 로깅과 에러 응답
   * 스택 트레이스 등 내부 정보의 클라이언트 노출 엄격 차단
   * 로그 및 응답 데이터에서 민감 정보(비밀번호, 토큰) 마스킹 자동화

2. 구조화된 통합 모니터링
   * JSON 기반 구조화 로깅 및 Trace ID/Correlation ID를 통한 분산 추적
   * 로그(사건), 지표(상태), 트레이스(동선)의 맥락적 연결

3. 운영 신뢰성 확보
   * 정기적인 데이터 백업 및 실제 복구 훈련 수행
   * 알림 피로도 관리를 위한 타겟팅 및 등급별 알림 정책 운영

### 4. 보안 인프라 및 핵심 로직

1. 입력 기반 공격 방어
   * SSRF 방지를 위한 URL/IP 화이트리스트 검증
   * 파라미터 바인딩 및 입력 정규화를 통한 다양한 인젝션(SQL, 명령) 차단
   * 파일 업로드 시 매직 넘버 검사 및 실행 권한 배제

2. 인증/인가와 공급망 보안
   * 리소스 소유권 기반의 세밀한 권한 검증 (Broken Access Control 방어)
   * 시크릿 매니저를 통한 자격 증명 관리 및 주기적 로테이션
   * 의존성 취약점 스캔 및 잠금 파일 관리를 통한 공급망 보안 강화

3. 비즈니스 정합성 보장
   * 핵심 규칙을 도메인 계층에 응집하여 비즈니스 불변식 강제
   * 올림/절사 등 금액 처리 규칙의 전사적 일관성 유지
   * 엄격한 상태 머신 전이 규칙을 통한 허용되지 않는 상태 변화 차단
