# Qdrant v1.13.0 - v1.14.0 아키텍처 리포트: 검색 결과 제어와 엔진 안정성의 진화

정리하겠습니다. Qdrant는 2024년 11월부터 2025년 12월까지 **'엔진의 안정성과 효율성(Mmap)'**을 높이면서 **'검색 결과 제어 능력'**을 극대화했습니다. 특히 v1.13.0과 v1.14.0을 기점으로 **검색 순위 결정 로직**과 **데이터 관리 방식**에 근본적인 변화가 발생했습니다.

확인 가능한 릴리스 노트를 기준으로, 실무 코드에 영향을 미치는 핵심 변화만을 추려 제시합니다.

---

## 1. Executive Summary: 핵심 아키텍처 변화 (v1.13.0, v1.14.0)

| 버전 | 릴리즈 시기 | 핵심 아키텍처 변화 (Architectural Impact) |
| :--- | :--- | :--- |
| **v1.13.0** | '25.01 | **Memory Strategy:** Payload/Sparse Vector의 기본 저장소를 **mmap 기반**으로 전환. (RSS 메모리 감소, OS 캐시 의존도 증가). |
| | | **Integrity:** **Strict Mode** 도입으로 컬렉션별 쓰기 속도 및 포인트 수 제어 가능. |
| | | **Feature Flag:** **Has Vector 필터** 추가. 다중 벡터 타입 기반의 정교한 필터링 지원. |
| **v1.14.0** | '25.04 | **Ranking Control:** **서버 측 점수 공식(User-defined formula)** 지원. 유사도 외 Payload 기반 가중치를 최종 점수에 반영. |
| | | **Pagination Logic:** Offset 파라미터 동작 변경. Prefetch와 조합된 복잡한 페이지네이션 로직 점검 필수. |

---

## 2. Critical Action Items: 코드 및 운영 정책 점검

### 2-1. 데이터 관리 및 운영 (v1.13.0+)

* **메모리 모니터링 전환:** v1.13.0부터 Payload 및 Sparse Vector가 **mmap**을 사용하면서, 프로세스 **RSS** 메모리 사용량이 감소합니다. 메모리 부족 시 프로세스가 죽는 대신 느려지는 동작으로 바뀌었으므로, **OS 캐시 및 디스크 I/O** 모니터링을 강화해야 합니다.
* **GPU HNSW 활용:** v1.13.0부터 GPU 기반 HNSW 인덱싱이 지원됩니다. 대규모 컬렉션 초기 인덱싱 시간을 단축시키려면, Qdrant 설정 파일에서 GPU 옵션을 활성화하십시오. (v1.13.2부터 다양한 GPU 호환성 확보).

### 2-2. 쿼리 로직 및 결과 제어 (v1.14.0)

* **점수 공식 재정의:** 기본 벡터 유사도에 Payload 필드(예: `popularity`, `freshness`)를 조합하여 검색 순위를 결정하는 **서버 측 점수 공식**을 활용하십시오. 이는 애플리케이션 레벨에서 후처리하던 랭킹 로직을 DB 엔진으로 이관하여 Latency를 줄이는 가장 확실한 방법입니다.

* **페이지네이션 로직 수정:** v1.14.0에서 `offset` 파라미터가 prefetch 쿼리 자체에 전파되지 않도록 동작이 변경되었습니다. `offset`과 `prefetch`를 함께 사용하는 **복잡한 페이지네이션 구현체**는 반드시 회귀 테스트를 수행하여 결과 순서 오류를 확인해야 합니다.

### 2-3. 보안 및 거버넌스 (v1.13.3, v1.13.4)

* **Strict Mode 채택:** 새로운 컬렉션을 생성할 때 **Strict Mode**를 기본 정책으로 지정하십시오. v1.13.4에서 추가된 '최대 포인트 수 제한' 옵션을 활용하여, 데이터 유실을 유발하는 버그나 악의적인 대량 쓰기 공격을 컬렉션 레벨에서 방어하십시오.
* **Rate Limit 대응:** REST API 클라이언트에서 Rate Limit 응답(429)을 받을 경우, 응답 헤더의 **`Retry-After`** 값을 참조하여 재시도 시간을 지능적으로 결정하도록 코드를 수정하십시오.

---

## 3. Strategic Recommendations

* **Sparse Vector 활용 확대:** v1.12.6의 64비트 차원 인덱스 지원으로, 극도로 높은 차원을 사용하는 Sparse Vector 모델(예: 희소 임베딩)을 설계 제약 없이 사용할 수 있게 되었습니다.
* **Observability 통합:** v1.12.6의 **JSON 로그 포맷** 지원을 활성화하고, 로그 수집 파이프라인(Loki, ELK 등)과 통합하여 Qdrant의 클러스터 상태 및 쿼리 성능을 구조화된 로그 기반으로 모니터링하십시오.

Qdrant는 v1.13.0 이후 엔진 깊숙한 곳에서 변화를 꾀하며, **검색 결과의 정확한 제어**와 **분산 환경에서의 안정적인 동작**을 핵심 가치로 삼고 있습니다. 업그레이드 시에는 **Strict Mode**와 **점수 공식** 도입을 통해 벡터 검색 시스템의 성능과 신뢰도를 동시에 높이는 전략을 취하십시오.
