# Shiki 주요 변경점 정리

2024-11-13 이후 Shiki는 1.x 후반 → 2.x → 3.x로 크게 바뀌었으며, 실무에서는 핵심 변화만 추려 따라가면 충분합니다.

아래 순서로 정리했습니다.

1. 기간 내 주요 버전·날짜 타임라인
2. 실제 코드에 영향 있는 변화 요약

## 1. 2024-11-13 ~ 2025-12-07 Shiki 주요 버전 타임라인

모든 패치를 다루지는 않았고, 코드 사용에 의미가 있는 마이너 이상만 추렸습니다. 날짜는 GitHub Releases 기준입니다.

| 버전                        | 릴리스 날짜        | 한줄 비고                                                                                       |
| ------------------------- | ------------- | ------------------------------------------------------------------------------------------- |
| v1.23.0                   | 2024-11-15    | JS 엔진에 Oniguruma-to-ES 도입, colorized-brackets 포트, Style-to-Class transformer 추가 |
| v1.23.1                   | 2024-11-18    | Oniguruma-to-ES 업데이트, 추가 문법 지원                                                           |
| v1.24.0                   | 2024-11-28    | JS 엔진 호환성 향상, 더 많은 문법 지원, 언어 추가                                                        |
| (v1.24.x 여러 패치)           | 2024-12       | 엔진·문법·테마 업데이트, 일부 유틸 노출 보완¹                                                       |
| v2.0.0                    | 2025-01-20    |  Shiki v2 메이저, 패키지 구성·아키텍처 정리, 새 공식 사용 권장 패턴                                        |
| v2.3.1 · v2.3.2           | 2025-02-05·06 | 문법 업데이트, Monaco 관련 버그 수정 수준                                                             |
| v2.4.0                    | 2025-02-15    | shortcuts에서 embedded language 추측·자동 로드 기능 추가                                             |
| v2.4.1                    | 2025-02-15    | core에서 guessEmbeddedLanguages 공개                                                            |
| v2.4.2                    | 2025-02-17    | ANSI 출력용 라이브러리 교체, latTokenVariants 유틸 공개                                           |
| v2.5.0                    | 2025-02-18    | transformer 관련 버그 수정 (v3.0.0과 동시 릴리스)                                                      |
| v3.0.0                    | 2025-02-18    | v2에서 예고된 deprecated API 실제 제거, twoslash 기본 moduleResolution 변경 등 큰 브레이킹                 |
| v3.1.0                    | 2025-02-27    | 3.x 초기 안정화 시작, 내부 개선 (공개 API 변화는 작음)                                                   |
| v3.1.1 · 3.1.2 · 3.1.3    | 2025-03-10·11 | 연속 버그 수정 릴리스                                                                             |
| v3.2.0 · 3.2.1            | 2025-04-25·27 | 토큰 관련 기능·유틸 정리, 버그 수정                                                                  |
| v3.3.0                    | 2025-05-05    | 3.x 라인 기능 확장, 일부 옵션·유틸 추가                                                              |
| v3.4.0                    | 2025-06-05    | 코어 기능 개선, 토큰·테마 핸들링 고도화                                                               |
| v3.5.0                    | 2025-06-07    | 추가 기능·옵션, 일부 동작 변경 (세부는 아래 2번 표)                                                      |
| v3.6.0                    | 2025-06-19    | 성능·구조 개선, 사용 패턴은 큰 변화 없음                                                               |
| v3.7.0                    | 2025-06-20    | API 표면을 다듬는 릴리스                                                                             |
| v3.8.0                    | 2025-08-14    | transformer/shortcuts 기능 확장                                                                  |
| v3.9.0                    | 2025-08-20    | 3.x 기능성 지속 확장, 옵션 보강                                                                     |
| v3.10.0                   | 2025-08-27    | 코드·토큰 출력 관련 주요 기능 추가, 3.x 중간 분기점                                                      |
| v3.11.0 · 3.11.1          | 2025-08-28    | 바로 다음날 연속 릴리스, 3.10 기능 안정화                                                               |
| v3.12.0 · 3.12.1 · 3.12.2 | 2025-09-02·03 | 새 기능과 패치가 섞인 세트, 3.10/3.11 위에 안정층                                                          |
| v3.13.0 · 3.13.1          | 2025-09-13·16 | 기능 보강·버그 수정, API 표면은 거의 동일                                                               |
| v3.14.0 · 3.14.1          | 2025-10-03    | 3.14에서 기능 추가, 같은 날 패치(3.14.1)로 다듬음                                                         |
| v3.15.0                   | 2025-10-25    | 일부 옵션·동작 재조정, 3.12 이후 또 한 번의 분기점                                                         |
| v3.16.0                   | 2025-10-29    | 내부 개선, 공개 API 변화는 적음                                                                         |
| v3.17.0                   | 2025-11-15    | 기능·옵션 추가 릴리스                                                                                |
| v3.18.0                   | 2025-11-22    | 3.17 위에 소규모 기능·정리                                                                          |
| v3.19.0                   | 2025-12-03    | 2025-12-07 기준 최신 메이저 마이너, 3.x 최신 기능 포함                                                     |

¹ 1.24.x 패치 중 하나에서  ransformerNotationMap 같은 내부 유틸이 외부에서 쓸 수 있도록 제대로 노출됩니다. 알고 있으면 편한 수준이라 아래 2번 표에서는 간단히만 언급합니다.

## 2. 실제 코드에 영향 있는 변화만 버전별 요약

단순 버그·성능·문법 업데이트는 제외하거나 한 줄로만 언급하고, API 변화나 구조 조정 같은 코드 수정 포인트만 모았습니다.

### 2-1. v1.23.0

| 항목         | 내용                                                                                                                                                                      |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 성격         | 마이너, 기능 추가                                                                                                                                                              |
| 핵심 변화      | JS 엔진에서 Oniguruma-to-ES를 사용하도록 전환, 괄호 색칠(colorized-brackets) 기능과 Style-to-Class transformer 도입                                                                                          |
| 왜 나한테 중요한가 | 브라우저나 Edge 런타임에서의 정규식 엔진 의존성이 줄고, transformer 기반으로 하이라이트 결과를 후처리해 CSS 클래스로 바꾸는 패턴을 공식적으로 밀기 시작한 버전                                                                   |
| 코드 영향      | @michael-makes/shiki-colorized-brackets 계열 기능을 쓰려면 이 버전 이상이 필요하며, transformer 파이프라인에 Style-to-Class를 끼워서 `<span style="...">` 문자열을 tailwind/unocss 클래스 구조로 변환하기 쉬워짐 |

이 버전부터 Shiki = core + transformer 파이프라인 구도가 분명해집니다.

### 2-2. v1.24.x

대표적으로 v1.24.0만 적습니다.

| 항목     | 내용                                                                                  |
| ------ | ----------------------------------------------------------------------------------- |
| 성격     | 마이너, 엔진·호환성 강화                                                                      |
| 핵심 변화  | JS 엔진 의존성 업그레이드, pre-ES2024 환경에서의 호환성 강화, 더 많은 문법 지원                          |
| 왜 중요한가 | 오래된 Node/브라우저까지 지원해야 할 때 JS 엔진 버그가 줄어 안정성이 올라감                                        |
| 코드 영향  | Shiki를 번들링할 때 JS 엔진 번들이 약간 변할 수 있으므로 번들 크기·트리셰이킹을 다시 점검. 공개 API 호출 방식은 그대로 유지 |

1.24.x 패치 중 하나에서  ransformerNotationMap 같은 내부 매핑이 외부에 노출돼 custom transformer 조합을 만들 때 타입·자동완성이 편해집니다.

### 2-3. v2.0.0 Shiki v2

공식 블로그에서 별도로 홍보한 메이저라 마이그레이션 체크가 필요합니다.

| 항목              | 내용                                                                                                                                                                                                                                                        |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 성격              | 메이저 브레이킹 릴리스 (실제 API 제거)                                                                                                                                                                                                                      |
| 핵심 Breaking 목록  | 1) v2에서 deprecated로 예고된 API 삭제. 2) Node 10 타입스크립트 moduleResolution 지원 제거. 3) twoslash 기본 moduleResolution을 `bundler`로 변경.                                                                                                       |
| 왜 중요한가          | v2에서 미뤘던 deprecated 호출이 3.0에서 바로 터질 수 있음. 오래된 TS 설정을 공유하는 monorepo에서 twoslash를 쓰면 moduleResolution 차이로 타입 해석이 달라질 수 있음.                                                                                      |
| 코드 영향·마이그레이션 감각 | 1) v3로 올릴 때 레포의 `@deprecated` 표기를 grep해 교체. 2) twoslash를 직접 돌리면 tsconfig의 `moduleResolution`을 `bundler` 기준으로 맞추거나 명시적으로 override. 3) Node 10, 구버전 TS 전제를 가진 빌드 파이프라인은 정리 필요 |

### 2-6. v3.1.x ~ v3.2.x

* v3.1.x: 3.0에서 제거한 API 주변 버그를 다듬는 구간. 3.0으로 올렸다면 최소 3.1.3 이상까지 따라가는 것이 안전합니다.
* v3.2.x: 토큰 유틸, 다중 테마 토큰 처리 등 토큰·테마 세밀 제어 기능이 정리되는 구간. 코어 API를 직접 다루면 3.2 기준 문서를 한 번 읽어두는 것이 좋습니다.

### 2-7. v3.3.0 ~ v3.7.0

* 3.3.0·3.4.0: 코어·transformers에 새 옵션과 유틸이 조금씩 추가. 기존 사용법이 깨지지 않습니다.
* 3.5.0: 기능 추가와 함께 기본 동작이 더 직관적으로 조정되는 구간. 래퍼를 만들었다면 추상화가 여전히 적절한지 점검할 만합니다.
* 3.6.0·3.7.0: 성능·구조 개선 위주. 런타임·번들러·Edge 환경 안정성을 위해 올려두기 좋고, 공개 API 변화는 작습니다.

### 2-8. v3.8.0 ~ v3.12.x

* 3.8.0·3.9.0: transformers와 shortcuts가 커지며 코드 → 토큰 → 후처리 → HTML 파이프라인 도구 느낌이 강화됩니다.
* 3.10.0: 코드·토큰 출력 기능을 크게 정리한 분기점. 여러 테마·모드로 한 번에 렌더링하려면 3.10 기준 API를 참고하면 좋습니다.
* 3.11.x·3.12.x: 3.10에서 도입한 기능을 안정화하고 세밀한 옵션·유틸을 채워 넣는 단계. 최근 예제와 가장 잘 맞는 버전대입니다.

### 2-9. v3.13.0 ~ v3.19.0

* 3.13.x·3.14.x: 기존 기능을 다듬고 버그를 잡는 릴리스. 3.14라면 3.14.1까지 따라가는 것이 자연스럽습니다.
* 3.15.0: 3.12/3.14 사이 기능을 종합해 중간 분기점 역할. 장기 유지 시 이 버전 이상이 무난합니다.
* 3.16.0 ~ 3.18.0: 내부 품질·성능·호환성 향상 위주. API 변화는 작지만 다양한 런타임 오동작 리스크를 줄여줍니다.
* 3.19.0: 2025-12-07 기준 최신. 신규 프로젝트는 이 버전을 기준으로, 장기 유지 프로젝트는 3.0 → 3.5 → 3.10 → 3.15 → 3.19처럼 분기점 점프 전략을 선택할 수 있습니다.

## 3. 마이그레이션 전략 한 줄 요약

* 새 프로젝트: v3 최신(현재 3.19.0) 기준으로 @shikijs/core, @shikijs/transformers, shortcuts 조합 패턴을 전제로 설계.
* v1에서 오래 써온 코드: v2.0.0을 참고해 1.x 전용 API를 정리하고, 3.0.0에서 제거된 deprecated API를 없앤 뒤 3.10이나 3.15 같은 분기점까지 단계적으로 올리기.
* twoslash·Monaco·CLI 같은 서브 패키지를 직접 쓴다면: v2.4.x와 v3.0.0 변경사항(embedded language 추론, moduleResolution, ANSI 색 처리 등)을 특히 주의 깊게 확인.
