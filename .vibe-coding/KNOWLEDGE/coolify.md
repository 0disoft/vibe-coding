# Coolify v4.0.0-beta.361 - .452 아키텍처 리포트: 보안 강화와 DevOps 분리

2024년 말부터 2025년 말까지 Coolify v4 베타는 **'운영 토폴로지의 분리(Build vs. Runtime)'**와 **'치명적 취약점 해결을 통한 보안 강화'**에 집중했습니다. 특히 RCE 취약점 패치와 DB SSL 의무화는 단순 기능 업데이트를 넘어 다중 사용자 환경의 안정성을 보장하기 위한 구조적 변화입니다.

본 리포트는 해당 기간의 핵심 변경 사항을 분석하여, 실무에서 즉시 적용해야 할 인프라 및 코드 설정 전략을 제시합니다.

---

## 1. Executive Summary: 핵심 아키텍처 변화

| 버전                  | 핵심 키워드                  | 아키텍처 영향 (Architectural Impact)                                                                              |
| :-------------------- | :--------------------------- | :---------------------------------------------------------------------------------------------------------------- |
| **v4.0.0-beta.361**   | **Auth Policy**              | **[Security]** Fortify 기반 비밀번호 정책 강화. 사용자 가입 및 테스트 시 비밀번호 강도 상향 요구.                 |
| **v4.0.0-beta.399**   | **DB SSL Mandatory**         | **[Security]** 데이터베이스 연결에 TLS 지원 도입. 평문 DB 통신의 시대 종료.                                       |
| **v4.0.0-beta.408**   | **Build/Runtime Separation** | **[DevOps]** 빌드 전용 서버 정의. 단일 서버에서 빌드와 런타임을 혼용하는 토폴로지 지양.                           |
| **v4.0.0-beta.420.7** | **RCE Patch**                | **[Critical Fix]** 프로젝트 생성 워크플로우 내 치명적인 RCE 및 XSS 취약점 패치. 다중 사용자 환경 업그레이드 필수. |
| **v4.0.0-beta.447**   | **Ops Simplification**       | **[DR/Backup]** S3에서 데이터베이스 백업을 직접 복원하는 기능 도입. 운영 복잡도 감소.                             |

---

## 2. Critical Action Items: 보안 및 인프라 전략

### 2-1. 치명적 취약점 대응

- **RCE 패치 필수:** 다중 사용자 환경(팀 멤버 등)에서는 **최소 v4.0.0-beta.420.7 이상**으로 즉시 업데이트해야 합니다. 그 이전 버전은 프로젝트 이름 등을 악용한 쉘 명령 주입 공격에 취약합니다.
- **비밀번호 강도:** E2E 테스트 스크립트 등에서 사용하는 테스트 계정 비밀번호의 강도를 **Fortify 정책**에 맞춰 조정하십시오.

### 2-2. 인프라 연결 정책 재정립

- **DB SSL 의무화 (v4.0.0-beta.399+):** 데이터베이스 연결 시 `sslmode=disable` 같은 옵션을 제거하고, **TLS 연결을 기본 전제**로 커넥션 스트링 템플릿을 수정하십시오.
- **토폴로지 분리:** CI/CD 파이프라인 설계 시, 빌드 전용 서버(`build server` 플래그)를 정의하고 런타임 서버와 분리하는 **GitOps 기반의 이중화 아키텍처**를 채택하십시오.
- **터미널 접근 제어 (v4.0.0-beta.419):** Coolify 터미널 접근을 루트/어드민으로 제한하고, 운영 시 터미널 접근을 강제하는 대신 로그 및 메트릭으로 디버깅하는 워크플로우로 전환하십시오.

### 2-3. DevOps 자동화 및 템플릿

- **환경 변수 템플릿:** v4.0.0-beta.447의 `{{ scope.variable }}` 문법을 활용하여, 공유 환경 변수나 DB 연결 정보를 하드 코딩 대신 템플릿 기반으로 관리하십시오. 이는 휴먼 에러를 줄이고 설정의 일관성을 확보합니다.
- **S3 백업 복원:** DB 백업/복원 스크립트를 수정하여, Coolify의 내장 S3 복원 기능을 활용하도록 단순화하십시오. 별도의 복원 서버를 구성할 필요 없이 운영 복잡도가 감소합니다.

---

## 3. Strategic Considerations

- **Traefik 설정 점검:** v4.0.0-beta.452는 Traefik 관련 보안 패치를 포함하지만, 일부 회귀 버그가 보고되고 있습니다. 프로덕션 환경에서는 450~451 버전에서 기능을 고정하고, 452 이후의 안정화 릴리스를 기다리는 보수적인 업그레이드 전략이 합리적입니다.
- **Docker 빌드 제어:** v4.0.0-beta.450의 빌드 캐시 제어 옵션을 활용하여, 모노레포 등 빌드 시간이 긴 프로젝트의 성능을 튜닝하십시오. 캐시를 명확하게 관리함으로써 CI/CD 시간을 단축할 수 있습니다.

Coolify v4는 플랫폼의 성숙도를 높여가는 과정에 있으며, **최소한의 보안 기준(v4.0.0-beta.420.7 이상)**을 지키면서 신규 기능을 점진적으로 도입하는 것이 안전한 전략입니다.
